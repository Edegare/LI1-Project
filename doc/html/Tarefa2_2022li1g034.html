<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g034</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Edgar Ferreira &lt;a99890@alunos.uminho.pt&gt;<br />Oleksii Tantsura &lt;a102131@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa2_2022li1g034</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:geraListaAleatorios">geraListaAleatorios</a> :: Int -&gt; Int -&gt; [Int]</li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:obsIniciais">obsIniciais</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:obsSeguidos">obsSeguidos</a> :: Int -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; Int</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Principal</h2><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g034.html#v:estendeMapa" title="Tarefa2_2022li1g034">estendeMapa</a></code>, que recebe um <strong>Mapa</strong> e retorna <strong>Mapa</strong>, &#233; composta pela conjun&#231;&#227;o de fun&#231;&#245;es auxiliares, que deve gerar e adicionar uma linha valida ao topo do mapa recebido. 
Basicamente, a funcao aceita o seed que e usado para generar o terreno valido. depois usando aquele terreno genera os obstaculos validos. Usando estes dados construe a nova mapa valida. 
a funcao auxiliar forLoop e usada para generar a lista valida dos obstaculos.
A fun&#231;&#227;o &#233; assim definida por : </p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa (Mapa width []) randomNumber= 
    let 
        velocidadeArr = [1, -1, 2, -2]
        terrenoGenerated = (proximosTerrenosValidos (Mapa width []))!!(mod randomNumber 3)
        finalTerreno = (if(terrenoGenerated == Rio 0) then Rio (velocidadeArr !! (mod randomNumber 4)) else if (terrenoGenerated == Estrada 0) then Estrada (velocidadeArr !! (mod randomNumber 4)) else Relva)
        randomList = geraListaAleatorios randomNumber width
        forLoop :: Int -&gt; Int -&gt; [Obstaculo] -&gt; [Obstaculo]
        forLoop i j accum | i&lt;j = (forLoop (i+1) j (accum ++ [chosenObstacle]))
                          | otherwise = accum
            where
                obstacleOptions = proximosObstaculosValidos width (finalTerreno, accum)
                chosenObstacle = obstacleOptions !! (if (length obstacleOptions) == 2 then mod (randomList !! i) 2 else mod (randomList !! i) 1)
        finalObstaculos = forLoop 0 width []
    in
        (Mapa width [(finalTerreno, finalObstaculos)])
estendeMapa (Mapa width (x:xs)) randomNumber = 
    let 
        velocidadeArr = [1, -1, 2, -2]
        terrenoGenerated = (proximosTerrenosValidos (Mapa width (x:xs))) !! (if length ((proximosTerrenosValidos (Mapa width (x:xs)))) == 3 then mod randomNumber 3 else mod randomNumber 2)
        finalTerreno = (if(terrenoGenerated == Rio 0) then Rio (velocidadeArr !! (mod randomNumber 4)) else if (terrenoGenerated == Estrada 0) then Estrada (velocidadeArr !! (mod randomNumber 4)) else Relva)
        randomList = geraListaAleatorios randomNumber width
        forLoop :: Int -&gt; Int -&gt; [Obstaculo] -&gt; [Obstaculo]
        forLoop i j accum | i&lt;j = (forLoop (i+1) j (accum ++ [chosenObstacle]))
                          | otherwise = accum
            where
                obstacleOptions = proximosObstaculosValidos width (finalTerreno, accum)
                chosenObstacle = obstacleOptions !! (if (length obstacleOptions) == 2 then mod (randomList !! i) 2 else mod (randomList !! i) 1)
        finalObstaculos = forLoop 0 width []
    in
        (Mapa width ([(finalTerreno, finalObstaculos)]++(x:xs)))
</pre></div></div><div class="top"><p class="src"><a id="v:geraListaAleatorios" class="def">geraListaAleatorios</a> :: Int -&gt; Int -&gt; [Int] <a href="#v:geraListaAleatorios" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Auxiliar</h2><p><code><a href="Tarefa2_2022li1g034.html#v:geraListaAleatorios" title="Tarefa2_2022li1g034">geraListaAleatorios</a></code> gera uma lista de aleat&#243;rios de acordo com a semente e o comprimento que pretende.  </p></div></div><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Auxiliar</h2><p><code><a href="Tarefa2_2022li1g034.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g034">proximosTerrenosValidos</a></code> &#233; uma fun&#231;&#227;o auxiliar que retorna a lista dos proximos terrenos validos (possiveis) para a mapa dada.</p></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Auxiliar</h2><p><code><a href="Tarefa2_2022li1g034.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g034">proximosObstaculosValidos</a></code> &#233; uma fun&#231;&#227;o auxiliar que retorna a lista de obstaculos validos para o terreno dado.</p></div></div><div class="top"><p class="src"><a id="v:obsIniciais" class="def">obsIniciais</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:obsIniciais" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Auxiliar</h2><p><code><a href="Tarefa2_2022li1g034.html#v:obsIniciais" title="Tarefa2_2022li1g034">obsIniciais</a></code> &#233; uma fun&#231;&#227;o auxiliar que cria uma lista com os obstaculos iniciais iguais.</p></div></div><div class="top"><p class="src"><a id="v:obsSeguidos" class="def">obsSeguidos</a> :: Int -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; Int <a href="#v:obsSeguidos" class="selflink">#</a></p><div class="doc"><h2>Fun&#231;&#227;o Auxiliar</h2><p><code><a href="Tarefa2_2022li1g034.html#v:obsSeguidos" title="Tarefa2_2022li1g034">obsSeguidos</a></code> &#233; uma fun&#231;&#227;o auxiliar que diz quantos obstaculos seguidos no tem no final da lista.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>